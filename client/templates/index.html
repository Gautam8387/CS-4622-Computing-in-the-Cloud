<!-- ./client/templates/index.html -->
{% extends "_base.html" %}

{% block title %}Media Transcoder - Upload{% endblock %}

{% block content %}
    <h2>Convert your media files</h2>
    <p>Fast, secure, and reliable transcoding in the cloud.</p>

    {% if user_info %}
        <section id="upload-section">
            <h3>Start a New Transcoding Job</h3>
            <form id="upload-form" enctype="multipart/form-data">
                 <div class="form-group">
                    <label for="email">Email for download link (optional):</label>
                    <input type="email" id="email" name="email" value="{{ user_info.email }}" placeholder="Defaults to your login email">
                 </div>
                 <div class="form-group">
                     <label for="output_format">Select Output Format:</label>
                     <select id="output_format" name="output_format" required>
                         <optgroup label="Video">
                             <option value="mp4">MP4 (H.264/AAC)</option>
                             <option value="webm">WebM (VP9/Opus)</option>
                             <option value="avi">AVI</option>
                             <option value="mov">MOV</option>
                             <option value="mkv">MKV</option>
                         </optgroup>
                         <optgroup label="Audio">
                             <option value="mp3">MP3</option>
                             <option value="wav">WAV</option>
                             <option value="flac">FLAC</option>
                             <option value="aac">AAC</option>
                         </optgroup>
                     </select>
                 </div>
                 <div class="form-group">
                    <label for="media-file">Select File:</label>
                     <div id="drop-area">
                        <input type="file" id="media-file" name="media_file" required accept="audio/*,video/*">
                        <p>Drag & drop your file here or click to select</p>
                     </div>
                     <p id="file-info"></p>
                 </div>
                 <button type="submit" id="submit-button">Start Transcoding</button>
            </form>
            <div id="upload-progress" style="display: none;">
                <p>Uploading: <span id="upload-percentage">0</span>%</p>
                <progress id="upload-progress-bar" value="0" max="100"></progress>
            </div>
             <div id="job-status-section" style="margin-top: 20px;">
                 <!-- Status updates will appear here -->
            </div>
        </section>

        <section id="job-history-section">
            <h3>Recent Jobs</h3>
            <ul id="job-history-list">
                <li>Loading job history...</li>
            </ul>
             <button id="refresh-jobs-button">Refresh History</button>
        </section>

    {% else %}
        <p>Please sign in above to use the transcoding service and view your job history.</p>
    {% endif %}

{% endblock %}

{% block scripts_extra %}
<!-- Add any page-specific scripts if needed -->
{% endblock %}